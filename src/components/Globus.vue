

<template>
  <div class="globus">
    <svg class="globus__box" width="21.771vw" height="15.104vw">
      <use href="@/assets/img/sprite.svg#globus-box-icon"></use>
    </svg>

    <div class="globus__wrapper">
      <p class="globus__title">Международная деятельность</p>
      <div id="myearth" class="earth-container">
      </div>

      <div class="globus__text-contains">
        <div class="globus__text-row">
          <svg class="globus__icon" width="5vw" height="0.833vw">
            <use href="@/assets/img/sprite.svg#line1-icon"></use>
          </svg>
          <span>1116</span>
          <p>
            иностранных <br />
            студентов
          </p>
        </div>

        <div class="globus__text-row">
          <svg class="globus__icon" width="4.792vw" height="0.833vw">
            <use href="@/assets/img/sprite.svg#line2-icon"></use>
          </svg>
          <span>5680</span>
          <p>
            иногородних <br />
            студентов
          </p>
        </div>

        <div class="globus__text-row">
          <svg class="globus__icon" width="5vw" height="0.573vw">
            <use href="@/assets/img/sprite.svg#line3-icon"></use>
          </svg>
          <span>ХХ</span>
          <p>Партнеров</p>
        </div>
      </div>
      <div class="progress progress--left1">
        <p class="progress__text">01.07.2021</p>
        <svg
          width="100"
          height="12"
          viewBox="0 0 100 12"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="progress__icon"
        >
          <path d="M4.5 0H0.5L11.5 12H15.5L4.5 0Z" fill="#FB9B2B" />
          <path
            d="M40.5 0H36.5L47.5 12H51.5L40.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M22.5 0H18.5L29.5 12H33.5L22.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M58.5 0H54.5L65.5 12H69.5L58.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M88.5 0H84.5L95.5 12H99.5L88.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M10.5 0H6.5L17.5 12H21.5L10.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M46.5 0H42.5L53.5 12H57.5L46.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M76.5 0H72.5L83.5 12H87.5L76.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M28.5 0H24.5L35.5 12H39.5L28.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M64.5 0H60.5L71.5 12H75.5L64.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M16.5 0H12.5L23.5 12H27.5L16.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M52.5 0H48.5L59.5 12H63.5L52.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M82.5 0H78.5L89.5 12H93.5L82.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M34.5 0H30.5L41.5 12H45.5L34.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
          <path
            d="M70.5 0H66.5L77.5 12H81.5L70.5 0Z"
            fill="#FB9B2B"
            fill-opacity="0.2"
          />
        </svg>
      </div>

      <!-- <Progress class="progress--left1" v-bind:progress="progress.text1" /> -->

      <!-- <Progress class="progress--right1" v-bind:progress="progress.text2" /> -->
      <div class="progress progress--right1">
      <p class="progress__text">55% год</p>
      <svg
        width="100"
        height="12"
        viewBox="0 0 100 12"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path d="M95.5 0H99.5L88.5 12H84.5L95.5 0Z" fill="#F79A2D" />
        <path d="M59.5 0H63.5L52.5 12H48.5L59.5 0Z" fill="#F79A2D" />
        <path d="M77.5 0H81.5L70.5 12H66.5L77.5 0Z" fill="#F79A2D" />
        <path
          d="M41.5 0H45.5L34.5 12H30.5L41.5 0Z"
          fill="#F79A2D"
          fill-opacity="0.2"
        />
        <path
          d="M11.5 0H15.5L4.5 12H0.5L11.5 0Z"
          fill="#F79A2D"
          fill-opacity="0.2"
        />
        <path d="M89.5 0H93.5L82.5 12H78.5L89.5 0Z" fill="#F79A2D" />
        <path d="M53.5 0H57.5L46.5 12H42.5L53.5 0Z" fill="#F79A2D" />
        <path
          d="M23.5 0H27.5L16.5 12H12.5L23.5 0Z"
          fill="#F79A2D"
          fill-opacity="0.2"
        />
        <path d="M71.5 0H75.5L64.5 12H60.5L71.5 0Z" fill="#F79A2D" />
        <path
          d="M35.5 0H39.5L28.5 12H24.5L35.5 0Z"
          fill="#F79A2D"
          fill-opacity="0.2"
        />
        <path d="M83.5 0H87.5L76.5 12H72.5L83.5 0Z" fill="#F79A2D" />
        <path
          d="M47.5 0H51.5L40.5 12H36.5L47.5 0Z"
          fill="#F79A2D"
          fill-opacity="0.2"
        />
        <path
          d="M17.5 0H21.5L10.5 12H6.5L17.5 0Z"
          fill="#F79A2D"
          fill-opacity="0.2"
        />
        <path d="M65.5 0H69.5L58.5 12H54.5L65.5 0Z" fill="#F79A2D" />
        <path
          d="M29.5 0H33.5L22.5 12H18.5L29.5 0Z"
          fill="#F79A2D"
          fill-opacity="0.2"
        />
      </svg>
    </div>
    </div>
  </div>
</template>

<script>
import Progress from "./Progress.vue";
export default {
  name: "Globus",
  data() {
    return {
      progress: {
        text1: "01.06.2021",
        text2: "55% год",
      },
    };
  },

  mounted() {
    let myearth;
    let sprites = [];

    myearth = new Earth("myearth", {
      location: {
        lat: 20,
        lng: 20,
      },
      light: "none",
      mapImage: "./hologram-map.svg",
      transparent: true,
      autoRotate: true,
      autoRotateSpeed: 5,
      autoRotateDelay: 100,
      autoRotateStart: 1000,
    });

    myearth.addEventListener("ready", function () {
      this.startAutoRotate();

      // connections

      var line = {
        color: "#009CFF",
        opacity: 0.15,
        hairline: true,
        offset: -0.5,
      };

      for (var i in connections) {
        line.locations = [
          {
            lat: connections[i][0],
            lng: connections[i][1],
          },
          {
            lat: connections[i][2],
            lng: connections[i][3],
          },
        ];
        this.addLine(line);
      }

      // add 8 shine sprites

      for (var i = 0; i < 8; i++) {
        sprites[i] = this.addSprite({
          image: "./hologram-shine.svg",
          scale: 1,
          offset: -0.5,
          opacity: 1,
        });
        pulse(i);
      }
    });

    function getRandomInt(min, max) {
      min = Math.ceil(min);
      max = Math.floor(max);
      return Math.floor(Math.random() * (max - min)) + min;
    }

    function pulse(index) {
      var random_location =
        connections[getRandomInt(0, connections.length - 1)];
      sprites[index].location = {
        lat: random_location[0],
        lng: random_location[1],
      };

      sprites[index].animate("scale", 0.5, {
        duration: 320,
        complete: function () {
          this.animate("scale", 0.2, {
            duration: 320,
            complete: function () {
              setTimeout(function () {
                pulse(index);
              }, getRandomInt(100, 400));
            },
          });
        },
      });
    }

    var connections = [
      [59.651901245117, 17.918600082397, 41.8002778, 12.2388889],
      [59.651901245117, 17.918600082397, 51.4706, -0.461941],

      [13.681099891662598, 100.74700164794922, -6.1255698204, 106.65599823],
      [
        13.681099891662598, 100.74700164794922, 28.566499710083008,
        77.10310363769531,
      ],

      [30.12190055847168, 31.40559959411621, -1.31923997402, 36.9277992249],
      [30.12190055847168, 31.40559959411621, 25.2527999878, 55.3643989563],
      [30.12190055847168, 31.40559959411621, 41.8002778, 12.2388889],

      [
        28.566499710083008, 77.10310363769531, 7.180759906768799,
        79.88410186767578,
      ],
      [
        28.566499710083008, 77.10310363769531, 40.080101013183594,
        116.58499908447266,
      ],
      [28.566499710083008, 77.10310363769531, 25.2527999878, 55.3643989563],

      [-33.9648017883, 18.6016998291, -1.31923997402, 36.9277992249],

      [-1.31923997402, 36.9277992249, 25.2527999878, 55.3643989563],

      [41.8002778, 12.2388889, 51.4706, -0.461941],
      [41.8002778, 12.2388889, 40.471926, -3.56264],

      [19.4363, -99.072098, 25.79319953918457, -80.29060363769531],
      [19.4363, -99.072098, 33.94250107, -118.4079971],
      [19.4363, -99.072098, -12.0219, -77.114304],

      [-12.0219, -77.114304, -33.393001556396484, -70.78579711914062],
      [-12.0219, -77.114304, -34.8222, -58.5358],
      [-12.0219, -77.114304, -22.910499572799996, -43.1631011963],

      [-34.8222, -58.5358, -33.393001556396484, -70.78579711914062],
      [-34.8222, -58.5358, -22.910499572799996, -43.1631011963],

      [22.3089008331, 113.915000916, 13.681099891662598, 100.74700164794922],
      [22.3089008331, 113.915000916, 40.080101013183594, 116.58499908447266],
      [22.3089008331, 113.915000916, 31.143400192260742, 121.80500030517578],

      [35.552299, 139.779999, 40.080101013183594, 116.58499908447266],
      [35.552299, 139.779999, 31.143400192260742, 121.80500030517578],

      [33.94250107, -118.4079971, 40.63980103, -73.77890015],
      [33.94250107, -118.4079971, 25.79319953918457, -80.29060363769531],
      [33.94250107, -118.4079971, 49.193901062, -123.183998108],

      [40.63980103, -73.77890015, 25.79319953918457, -80.29060363769531],
      [40.63980103, -73.77890015, 51.4706, -0.461941],

      [51.4706, -0.461941, 40.471926, -3.56264],

      [
        40.080101013183594, 116.58499908447266, 31.143400192260742,
        121.80500030517578,
      ],

      [-33.94609832763672, 151.177001953125, -41.3272018433, 174.804992676],
      [-33.94609832763672, 151.177001953125, -6.1255698204, 106.65599823],

      [55.5914993286, 37.2615013123, 59.651901245117, 17.918600082397],
      [55.5914993286, 37.2615013123, 41.8002778, 12.2388889],
      [55.5914993286, 37.2615013123, 40.080101013183594, 116.58499908447266],
      [55.5914993286, 37.2615013123, 25.2527999878, 55.3643989563],
    ];
  },

  components: {
    Progress,
  },
};
</script>

<style lang="scss">
.progress--left1 {
  bottom: 0.5vw;
  left: 0.5vw;
}

.progress--right1 {
  bottom: 0.5vw;
  right: 0.5vw;
  text-align: right;

  .progress__icon {
    transform: scaleX(-1);
  }
}

.globus__text-contains {
  position: absolute;
  right: 3.125vw;
  top: 4.01vw;
}

.globus__icon {
  position: absolute;
  left: -5.5vw;
  top: 0.1vw;
}

.globus__text-row {
  position: relative;

  &:not(:last-of-type) {
    margin-bottom: 0.677vw;
  }

  span {
    display: block;
    font-size: 1.146vw;
    color: #fb9b2b;
    line-height: 1.042vw;
    margin-bottom: 0.156vw;
  }

  p {
    font-size: 0.469vw;
    line-height: 0.729vw;
    text-transform: uppercase;
    color: #627dae;
    letter-spacing: 0.1em;
  }
}

.globus {
  position: relative;
  width: 21.771vw;
  height: 15.104vw;
}

.globus__title {
  letter-spacing: 0.05em;
  font-size: 0.938vw;
  padding: 1.563vw;
}

.globus__wrapper {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  right: 0;
}

#myearth {
  width: 13.021vw;
  height: 13.021vw;
  top: -2.5vw;
}
</style>
